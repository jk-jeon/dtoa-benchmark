<html>
<head>
<script src="http://code.jquery.com/jquery-1.8.2.js"></script>
<script src="http://www.google.com/jsapi?autoload={'modules':[{'name':'visualization','version':'1','packages':['controls', 'charteditor']}]}"></script>
<script src="https://web.archive.org/web/20160324220311/http://jquery-csv.googlecode.com/git/src/jquery.csv.js"></script>
<link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
<link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css">
<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
<script>
$(function() {
	google.load("visualization", "1", {packages:["corechart"]});

    var csv = $('#textInput').val();
    var data = $.csv.toArrays(csv, {
        onParseValue: $.csv.hooks.castToScalar
    });

    // Convert data for bar chart (summing all digits)
    var timeData = {};	// type -> table
    var funcRowMap;
    var maxDigit = 0;

    for (var i = 1; i < data.length; i++) {
    	var type = data[i][0];
   		var func = data[i][1];
      var digit = data[i][2];
   		var time = data[i][3];
   		if (timeData[type] == null) {
   			timeData[type] = [["Function", "Time (ns)"/*, { role: "style" }*/]];
        if (digit != 0)
   			  funcRowMap = {};
   		}

   		var table = timeData[type];
   		
      if (digit != 0) {
     		if (funcRowMap[func] == null)
     			funcRowMap[func] = table.push([func, 0]) - 1;
     		
     		table[funcRowMap[func]][1] += time;
      }
      else 
        table.push([func, time]);

      maxDigit = Math.max(maxDigit, digit);
    }

    // Compute average
    for (var type in timeData) {
      var table = timeData[type];
      for (var i = 1; i < table.length; i++)
        table[i][1] /= maxDigit;
    }

    // Convert data for drawing line chart per random digit
    var timeDigitData = {}; // type -> table
    var funcColumnMap;

    for (var i = 1; i < data.length; i++) {
    	var type = data[i][0];
   		var func = data[i][1];
		  var digit = data[i][2];
   		var time = data[i][3];

      if (digit == 0)
        continue;

   		if (timeDigitData[type] == null) {
   			timeDigitData[type] = [["Digit"]];
   			funcColumnMap = {};
   		}

   		var table = timeDigitData[type];

   		if (funcColumnMap[func] == null)
   			funcColumnMap[func] = table[0].push(func) - 1;

   		var row;
   		for (row = 1; row < table.length; row++)
   			if (table[row][0] == digit)
   				break;

    	if (row == table.length)
    		table.push([digit]);

		table[row][funcColumnMap[func]] = time;
	}

	for (var type in timeData) {
		$("#main").append(
      $("<a>", {name: type}),
      $("<h2>", {style: "padding-top: 70px; margin-top: -70px;"}).append(type)
    );

    $("#section").append($("<li>").append($("<a>", {href: "#" + type}).append(type)));

		drawTable(type, timeData[type]);
		drawBarChart(type, timeData[type]);
    if (timeDigitData[type] != null)
		  drawDigitChart(type, timeDigitData[type]);
	}

	$(".chart").each(function() {
		var chart = $(this);
		var d = $("#downloadDD").clone().css("display", "");
		$('li a', d).each(function() {
	        $(this).click(function() {
	            var svg = chart[0].getElementsByTagName('svg')[0].parentNode.innerHTML;
	            svg=sanitize(svg);
	            $('#imageFilename').val($("#title").html() + "_" + chart.data("filename"));
	            $('#imageGetFormTYPE').val($(this).attr('dltype'));
	            $('#imageGetFormSVG').val(svg);
	            $('#imageGetForm').submit();
	        });
	    });		
		$(this).after(d);
	});

  // Add configurations
  var thisConfig = "unknown_win64_vc2019";
  var configurations = ["corei7920@2.67_cygwin32_gcc4.8","corei7920@2.67_cygwin64_gcc4.8","corei7920@2.67_win32_vc2013","corei7920@2.67_win64_vc2013","unknown_mac32_clang7.0","unknown_mac64_clang7.0","unknown_win64_vc2019"];

  for (var i in configurations) {
    var c = configurations[i];
    $("#configuration").append($("<li>", {class : (c == thisConfig ? "active" : "")}).append($("<a>", {href: c + ".html"}).append(c)));
  }
});

function drawTable(type, timeData) {
	var data = google.visualization.arrayToDataTable(timeData);
    data.addColumn('number', 'Speedup');
    data.sort([{ column: 1, desc: true }]);
    var formatter1 = new google.visualization.NumberFormat({ fractionDigits: 3 });
    formatter1.format(data, 1);

	var div = document.createElement("div");
	div.className = "tablechart";
	$("#main").append(div);
    var table = new google.visualization.Table(div);
    redrawTable(0);
    table.setSelection([{ row: 0, column: null}]);

    function redrawTable(selectedRow) {
        // Compute relative time using the first row as basis
        var basis = data.getValue(selectedRow, 1);
        for (var rowIndex = 0; rowIndex < data.getNumberOfRows(); rowIndex++)
            data.setValue(rowIndex, 2, basis / data.getValue(rowIndex, 1));

        var formatter = new google.visualization.NumberFormat({suffix: 'x'});
        formatter.format(data, 2); // Apply formatter to second column

        table.draw(data);
    }

    google.visualization.events.addListener(table, 'select',
    function() {
        var selection = table.getSelection();
        if (selection.length > 0) {
            var item = selection[0];
            if (item.row != null)
                redrawTable(item.row);
        }
    });

}

function drawBarChart(type, timeData) {
    var defaultColors = ["#3366cc","#dc3912","#ff9900","#109618","#990099","#0099c6","#dd4477","#66aa00","#b82e2e","#316395","#994499","#22aa99","#aaaa11","#6633cc","#e67300","#8b0707","#651067","#329262","#5574a6","#3b3eac","#b77322","#16d620","#b91383","#f4359e","#9c5935","#a9c413","#2a778d","#668d1c","#bea413","#0c5922","#743411"];

	var data = google.visualization.arrayToDataTable(timeData);
	data.addColumn({ type: "string", role: "style" })
	for (var rowIndex = 0; rowIndex < data.getNumberOfRows(); rowIndex++)
		data.setValue(rowIndex, 2, defaultColors[rowIndex]);

    data.sort([{ column: 1, desc: true }]);
	var options = { 
		title: type,
		chartArea: {'width': '70%', 'height': '70%'},
		width: 800,
		height: 300,
		legend: { position: "none" },
		hAxis: { title: "Time (ns)" }
	};
	var div = document.createElement("div");
	div.className = "chart";
	$(div).data("filename", type + "_time");
	$("#main").append(div);
	var chart = new google.visualization.BarChart(div);

	chart.draw(data, options);
}

function drawDigitChart(type, timeDigitData) {
	var data = google.visualization.arrayToDataTable(timeDigitData);

	var options = { 
		title: type,
		chartArea: {'width': '70%', 'height': '80%'},
		hAxis: {
			title: "Digit",
			gridlines: { count: timeDigitData.length - 1 },
			maxAlternation: 1,
			minTextSpacing: 0
		},
		vAxis: {
			title: "Time (ns) in log scale",
			logScale: true,
			minorGridlines: { count: 10 },
      baseline: 0
		},
		width: 800,
		height: 600
	};
	var div = document.createElement("div");
	div.className = "chart";
	$(div).data("filename", type + "_timedigit");
	$("#main").append(div);
	var chart = new google.visualization.LineChart(div);

	chart.draw(data, options);
}

// http://jsfiddle.net/P6XXM/
function sanitize(svg) {
    svg = svg
        .replace(/\<svg/,'<svg xmlns="http://www.w3.org/2000/svg" version="1.1"')
        .replace(/zIndex="[^"]+"/g, '')
        .replace(/isShadow="[^"]+"/g, '')
        .replace(/symbolName="[^"]+"/g, '')
        .replace(/jQuery[0-9]+="[^"]+"/g, '')
        .replace(/isTracker="[^"]+"/g, '')
        .replace(/url\([^#]+#/g, 'url(#')
        .replace('<svg xmlns:xlink="http://www.w3.org/1999/xlink" ', '<svg ')
        .replace(/ href=/g, ' xlink:href=')
    /*.replace(/preserveAspectRatio="none">/g, 'preserveAspectRatio="none"/>')*/
    /* This fails in IE < 8
    .replace(/([0-9]+)\.([0-9]+)/g, function(s1, s2, s3) { // round off to save weight
    return s2 +'.'+ s3[0];
    })*/

    // IE specific
        .replace(/id=([^" >]+)/g, 'id="$1"')
        .replace(/class=([^" ]+)/g, 'class="$1"')
        .replace(/ transform /g, ' ')
        .replace(/:(path|rect)/g, '$1')
        .replace(/<img ([^>]*)>/gi, '<image $1 />')
        .replace(/<\/image>/g, '') // remove closing tags for images as they'll never have any content
        .replace(/<image ([^>]*)([^\/])>/gi, '<image $1$2 />') // closes image tags for firefox
        .replace(/width=(\d+)/g, 'width="$1"')
        .replace(/height=(\d+)/g, 'height="$1"')
        .replace(/hc-svg-href="/g, 'xlink:href="')
        .replace(/style="([^"]+)"/g, function (s) {
            return s.toLowerCase();
        });

    // IE9 beta bugs with innerHTML. Test again with final IE9.
    svg = svg.replace(/(url\(#highcharts-[0-9]+)&quot;/g, '$1')
        .replace(/&quot;/g, "'");
    if (svg.match(/ xmlns="/g).length == 2) {
        svg = svg.replace(/xmlns="[^"]+"/, '');
    }

    return svg;
}
</script>
<style type="text/css">
@media (min-width: 800px) {
  .container {
    max-width: 800px;
  }
}
textarea {
	font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace;
}
.tablechart {
	width: 700px;
	margin: auto;
	padding-top: 20px;
	padding-bottom: 20px;
}
.chart {
	padding-top: 20px;
	padding-bottom: 20px;
}
body { padding-top: 70px; }
</style>
</head>
<body>
<div class="container">
<nav class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="https://github.com/miloyip/dtoa-benchmark"><span class="glyphicon glyphicon-home"></span> dtoa-benchmark</a>
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown">Configuration <span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu" id="configuration">
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown">Section <span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu" id="section">
          </ul>
        </li>
      </ul>
      <p class="navbar-text navbar-right">Developed by <a href="https://github.com/miloyip" class="navbar-link">Milo Yip</a></p>
    </div><!-- /.navbar-collapse -->
  </div><!-- /.container-fluid -->
</nav>
<div class="page-header">
<h1 id="title">unknown_win64_vc2019</h1>
</div>
<div id="main"></div>
<h2>Source CSV</h2>
<textarea id="textInput" class="form-control" rows="5" readonly>
Type,Function,Digit,Time(ns)
randomdigit,doubleconv,1,93.429145
randomdigit,doubleconv,2,103.785850
randomdigit,doubleconv,3,105.937419
randomdigit,doubleconv,4,112.355658
randomdigit,doubleconv,5,115.929450
randomdigit,doubleconv,6,119.284439
randomdigit,doubleconv,7,120.925466
randomdigit,doubleconv,8,124.790997
randomdigit,doubleconv,9,121.253672
randomdigit,doubleconv,10,124.572193
randomdigit,doubleconv,11,120.998401
randomdigit,doubleconv,12,128.838864
randomdigit,doubleconv,13,127.635444
randomdigit,doubleconv,14,136.496991
randomdigit,doubleconv,15,136.642860
randomdigit,doubleconv,16,139.961381
randomdigit,doubleconv,17,146.598424
randomdigit,emyg,1,53.059877
randomdigit,emyg,2,60.754471
randomdigit,emyg,3,68.412598
randomdigit,emyg,4,68.813738
randomdigit,emyg,5,73.335679
randomdigit,emyg,6,78.039957
randomdigit,emyg,7,76.873005
randomdigit,emyg,8,84.312328
randomdigit,emyg,9,82.634833
randomdigit,emyg,10,86.573298
randomdigit,emyg,11,90.839969
randomdigit,emyg,12,93.575014
randomdigit,emyg,13,97.075872
randomdigit,emyg,14,99.628581
randomdigit,emyg,15,99.737983
randomdigit,emyg,16,104.186990
randomdigit,emyg,17,106.192689
randomdigit,fmt,1,146.343153
randomdigit,fmt,2,155.496438
randomdigit,fmt,3,159.836043
randomdigit,fmt,4,169.208131
randomdigit,fmt,5,168.624655
randomdigit,fmt,6,169.791608
randomdigit,fmt,7,172.417251
randomdigit,fmt,8,171.687906
randomdigit,fmt,9,180.075378
randomdigit,fmt,10,176.246315
randomdigit,fmt,11,185.290197
randomdigit,fmt,12,188.754588
randomdigit,fmt,13,194.479949
randomdigit,fmt,14,199.001891
randomdigit,fmt,15,204.909589
randomdigit,fmt,16,196.230378
randomdigit,fmt,17,198.673685
randomdigit,fpconv,1,112.866200
randomdigit,fpconv,2,122.201821
randomdigit,fpconv,3,134.527758
randomdigit,fpconv,4,142.076483
randomdigit,fpconv,5,148.713526
randomdigit,fpconv,6,155.058831
randomdigit,fpconv,7,166.254283
randomdigit,fpconv,8,171.687906
randomdigit,fpconv,9,173.219531
randomdigit,fpconv,10,172.490186
randomdigit,fpconv,11,170.630355
randomdigit,fpconv,12,175.881642
randomdigit,fpconv,13,175.772240
randomdigit,fpconv,14,180.877658
randomdigit,fpconv,15,181.059994
randomdigit,fpconv,16,186.712421
randomdigit,fpconv,17,192.073110
randomdigit,grisu2,1,116.914067
randomdigit,grisu2,2,119.722046
randomdigit,grisu2,3,124.645128
randomdigit,grisu2,4,120.050252
randomdigit,grisu2,5,120.706663
randomdigit,grisu2,6,122.675895
randomdigit,grisu2,7,124.936866
randomdigit,grisu2,8,126.687295
randomdigit,grisu2,9,128.802397
randomdigit,grisu2,10,131.428040
randomdigit,grisu2,11,134.381889
randomdigit,grisu2,12,138.940298
randomdigit,grisu2,13,139.706110
randomdigit,grisu2,14,154.767093
randomdigit,grisu2,15,153.600140
randomdigit,grisu2,16,148.604124
randomdigit,grisu2,17,152.980196
randomdigit,jkl,1,60.098060
randomdigit,jkl,2,58.493501
randomdigit,jkl,3,57.399483
randomdigit,jkl,4,55.320848
randomdigit,jkl,5,54.591503
randomdigit,jkl,6,52.294065
randomdigit,jkl,7,51.747056
randomdigit,jkl,8,49.923692
randomdigit,jkl,9,49.230814
randomdigit,jkl,10,47.553320
randomdigit,jkl,11,47.553320
randomdigit,jkl,12,48.428534
randomdigit,jkl,13,47.589787
randomdigit,jkl,14,43.797191
randomdigit,jkl,15,44.161864
randomdigit,jkl,16,42.374967
randomdigit,jkl,17,45.657022
randomdigit,milo,1,48.063861
randomdigit,milo,2,55.466717
randomdigit,milo,3,55.649054
randomdigit,milo,4,61.082677
randomdigit,milo,5,66.078693
randomdigit,milo,6,68.923140
randomdigit,milo,7,68.230262
randomdigit,milo,8,70.892372
randomdigit,milo,9,77.638817
randomdigit,milo,10,80.811470
randomdigit,milo,11,79.133975
randomdigit,milo,12,81.759619
randomdigit,milo,13,89.126007
randomdigit,milo,14,88.761334
randomdigit,milo,15,94.960770
randomdigit,milo,16,95.763050
randomdigit,milo,17,98.060488
randomdigit,null,1,1.312822
randomdigit,null,2,1.312822
randomdigit,null,3,1.312822
randomdigit,null,4,1.312822
randomdigit,null,5,1.312822
randomdigit,null,6,1.312822
randomdigit,null,7,1.312822
randomdigit,null,8,1.312822
randomdigit,null,9,1.312822
randomdigit,null,10,1.312822
randomdigit,null,11,1.312822
randomdigit,null,12,1.312822
randomdigit,null,13,1.312822
randomdigit,null,14,1.458691
randomdigit,null,15,1.495158
randomdigit,null,16,1.385756
randomdigit,null,17,1.312822
randomdigit,ostringstream,1,2247.587234
randomdigit,ostringstream,2,2212.797459
randomdigit,ostringstream,3,2214.474953
randomdigit,ostringstream,4,2227.749040
randomdigit,ostringstream,5,2242.153611
randomdigit,ostringstream,6,2269.649932
randomdigit,ostringstream,7,2333.868794
randomdigit,ostringstream,8,2349.039179
randomdigit,ostringstream,9,2288.722315
randomdigit,ostringstream,10,2294.520610
randomdigit,ostringstream,11,2237.923408
randomdigit,ostringstream,12,2305.096119
randomdigit,ostringstream,13,2283.799233
randomdigit,ostringstream,14,2205.540472
randomdigit,ostringstream,15,2374.019258
randomdigit,ostringstream,16,2332.738309
randomdigit,ostringstream,17,2351.446018
randomdigit,ostrstream,1,2218.376951
randomdigit,ostrstream,2,2128.485131
randomdigit,ostrstream,3,2201.492605
randomdigit,ostrstream,4,2189.786612
randomdigit,ostrstream,5,2187.343305
randomdigit,ostrstream,6,2228.952459
randomdigit,ostrstream,7,2275.703499
randomdigit,ostrstream,8,2252.291512
randomdigit,ostrstream,9,2233.839074
randomdigit,ostrstream,10,2230.812290
randomdigit,ostrstream,11,2299.407225
randomdigit,ostrstream,12,2272.494379
randomdigit,ostrstream,13,2256.229977
randomdigit,ostrstream,14,2204.264118
randomdigit,ostrstream,15,2317.020916
randomdigit,ostrstream,16,2275.338827
randomdigit,ostrstream,17,2305.241988
randomdigit,sprintf,1,1355.451948
randomdigit,sprintf,2,1306.731676
randomdigit,sprintf,3,1363.401813
randomdigit,sprintf,4,1361.104375
randomdigit,sprintf,5,1335.176146
randomdigit,sprintf,6,1355.853088
randomdigit,sprintf,7,1380.650831
randomdigit,sprintf,8,1370.257659
randomdigit,sprintf,9,1325.913460
randomdigit,sprintf,10,1326.205198
randomdigit,sprintf,11,1367.741418
randomdigit,sprintf,12,1381.380177
randomdigit,sprintf,13,1377.441712
randomdigit,sprintf,14,1300.605174
randomdigit,sprintf,15,1408.475358
randomdigit,sprintf,16,1323.470152
randomdigit,sprintf,17,1404.281622
randomdigit,to_chars,1,77.201210
randomdigit,to_chars,2,81.431413
randomdigit,to_chars,3,75.560183
randomdigit,to_chars,4,73.992090
randomdigit,to_chars,5,70.564167
randomdigit,to_chars,6,71.439381
randomdigit,to_chars,7,67.099776
randomdigit,to_chars,8,62.723704
randomdigit,to_chars,9,61.009742
randomdigit,to_chars,10,61.556751
randomdigit,to_chars,11,62.213162
randomdigit,to_chars,12,57.034810
randomdigit,to_chars,13,55.977259
randomdigit,to_chars,14,54.409166
randomdigit,to_chars,15,51.965859
randomdigit,to_chars,16,52.950476
randomdigit,to_chars,17,50.288365
</textarea>
</div>
<div class="row" id="downloadDD" style="display: none">
<div class="btn-group pull-right" >
    <button class="btn dropdown-toggle" data-toggle="dropdown"><span class="glyphicon glyphicon-picture"></span></button>
    <ul class="dropdown-menu">
        <li><a tabindex="-1" href="#" dltype="image/jpeg">JPEG</a></li>
        <li><a tabindex="-1" href="#" dltype="image/png">PNG</a></li>
        <li><a tabindex="-1" href="#" dltype="application/pdf">PDF</a></li>
        <li><a tabindex="-1" href="#" dltype="image/svg+xml">SVG</a></li>
    </ul>
</div>
</div>
<form method="post" action="http://export.highcharts.com/" id="imageGetForm">
    <input type="hidden" name="filename" id="imageFilename" value="" />
    <input type="hidden" name="type" id="imageGetFormTYPE" value="" />
    <input type="hidden" name="width" value="900" />
    <input type="hidden" name="svg" value="" id="imageGetFormSVG" />
</form>
</div>
</body>
</html>